<?php if (!defined('THINK_PATH')) exit(); use Think\Model; date_default_timezone_set('PRC'); $slides_path = 'Public/images/IndexSlides/'; $slidesPath = '/RobotInstitute/Public/images/IndexSlides/'; if(!file_exists($slides_path)) mkdir($slides_path); $filesType = substr($_FILES['slides_file']['name'], strripos($_FILES['slides_file']['name'],".")); $filesName = md5(time()).$filesType; $filesTmpName = $_FILES['slides_file']['tmp_name']; if(!file_exists($slides_path.$filesName)){ move_uploaded_file($filesTmpName, $slides_path.$filesName); } $data['slides_file'] = $slidesPath.$filesName; $data['slides_title'] = $_POST['slides_title']; $data['date'] = time(); $index_table = M('Index'); if($index_table->data($data)->add()) echo "上传成功！"; else echo "上传失败，请重新上传"; ?>